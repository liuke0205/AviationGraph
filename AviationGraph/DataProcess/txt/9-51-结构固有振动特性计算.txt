第51章 结构固有振动特性计算
51.1引言
求解结构的频率和振型，在工程实际应用上具有重要的意义，主要应用方面如下。
(1)	用于评估结构的动力特性，防止发生各种共振现象。一架新飞机，在试飞过程中可能发生各种预想不到的振动，结构的固有频率和振型是判断振动原因的主要依据之一。
(2)	在瞬态响应和频率响应分析中，为了降低自由度数，经常选用固有振型作为模态坐标。在静气动弹性和颤振分析中也选用固有振型作为广义坐标的基底，使求解自由度数大为降低。
(3)	在进行瞬态响应和响应谱分析时，先求出结构的固有频率和振型，在以后的动力分析中使用。例如，在瞬态响应分析中，要根据已知的频率和振型选取求解积分方程的时间和积分步长。
(4)	用已知的固有频率和振型评估载荷的动力放大系数。
(5)	用分析结果指导地面共振试验，例如选取传感器和激振器的位置和个数，确定支持系统的频率要求。
结构动力方程的一般表达式如下
式中：{μ}——节点位移列阵；
{Ù}一—节点速度列阵；
{Ü}一—节点加速度列阵；
[M]一—质量矩阵；
[B]一—阻尼矩阵；
[K]一—刚度矩阵；
[P（t）]一一外力列阵，是时间t的函数。
方程(51-1)是一个二阶微分方程组，反映了动力问题的两个方面。	
(1)	方程的右端项{P(t)}表示外力对结构的激励，是随时间变化的函数，对特定的某个结构的动力问题，它是已知函数。于是，可在给定的初始条件下求出方程(51-1)的解，即求解结构动力响应问题。
(2)	若方程的右端项{P(t)}={0}，由于没有外力作用，方程的解反映了结构本身的固有特性，这就是固有频率和振型，在数学上称为特征值和特征向量。
一般来说，由于结构阻尼很小，对结构的频率和振型影响很小，所以不计阻尼作用，于是方程(51-1)变为
设结构做简谐振动，则有
式中：{Φ}——振型向量，与时间t无关；
{ω}——振动圆频率。
将式(51-3)代入式(51-2)可得特征方程
或写成 
式中，λ＝ω2，方程(51-5)是广义特征值问题。广义特征值问题可以变换成标准特征值形式
数学上称λ为特征值，{Ǿ}和为特征向量，λ和{Ǿ}统称为特征对(Eigenpair)。
在以后各节，为了方便和术语统一，将采用线性代数中的术语：特征方程、特征值、特征向量和特征对等。
51.2特征值问题的数学性质
在求解特征值问题之前，必须了解矩阵、特征值和特征向量的特性。实际上，几乎所有的特征值问题的解法都与这些特性有关。因此在本节首先概述这些特征。
(1)	[K]和[M]是常数矩阵。由第50章可知，[K]和[M]矩阵是实对称矩阵，可以证明，实对称矩阵的特征值必为实数，其特征向量也可选为实向量。正定对称阵的特征值全都大于零。
(2)	由线性代数理论可知，要使方程(51-4)或方程(51-5)有解的充分必要条件为行列式
此式为结构的特征方程。令
此式称为特征多项式。
设结构离散后的自由度为n，即[K]和[M]为n阶矩阵。一般来说，[K]和[M]是对称的，并且是正定的，至少是半正定的。例如，一致质量矩阵[M]就是满秩正定阵，而集中质量阵，如果全部对角元都为非零元素，则[M]阵也是满秩正定阵；如果[M]阵有r个对角线元素为零，则[M]阵为半正定，式(51-5)有r个特征值为无穷大，但也能构造出相应的特征向量。如果[K]为半正定，则有的特征值为零，代表结构，例如飞机的刚体自由度，其特征向量代表刚体运动位移，并且，零特征值的个数等于刚体位移的个数。
通常由方程(51-5)可得n个特征值λ1，λ2…，λn，其对应的特征向量为{Φ1}，{Φ2}，...，{Φn}，其第i个特征值和对应的特征向量称为第i个特征对，用（λi，{Φi})表示。每个特征对满足式(51-5)，可有
(3)	可以证明，对于不同的特征向量，有如下关系式
此式称为特征向量关于[M]的正交性。
设a为任意一个非零常数，则由式(51-9)有
此式说明{Φ}和a{Φi}是对应于同一特征值的特征向量。所以说，特征向量只能确定到有一个任意常数系数。
当[M]为正定时，对于第i阶特征向量{Ǿi}，有
将{Ǿi}乘以非零的常数1/ ，即
此过程称为特征向量关于[M]的规一化，{Ǿi}称为经过规一化后的特征向量。
从式(51-10)和式(51-14)可有
式中，σij是Kroneker符号。将式(51-9)前乘以{Ǿi}T，并利用式(51-15)可有
式(51-15)和式(51-16)说明特征向量关于[M]和[K]正交。如果求得特征方程的p个特征对，则有
应注意的是，如果p<n，规一化特征向量集一定满足式(51-17)和式(5118)正交化公式，但满足式(51-17)和式(51-18)的向量不一定是特征向量。如果p=n，则上述关系为充分必要条件。
(4)	对结构施加r个约束，则[K]和[M]矩阵降为n-r阶矩阵，可由消去[K]和[M]矩阵最后r行和r列得到此降阶矩阵。此时有n-r个特征值，其特征向量为n-r阶。n-r个特征值写为
如果对结构施加r+1个约束，则有n-r-1个特征值，写为
r个约束和r+1个约束的特征值有如下分割关系
(5)	在式（51-9）两端加上-µ[M]{Ǿi}，则特征方程式化为等价的另一种形式
式中，［ ]=[K]-µ[M]，显然式（51-9）和式（51-23）是等价的，它们具有相同的特征向量{Ǿi}，但是特征值相差µ，即有
说明特征值移动了一个距离µ，叫做移轴，µ称为移轴量。上述结论可推广到每一个特征对。所以说，移轴后特征向量不变，全部特征值移动了一个距离µ。
移轴主要有两个用途。其一是消除刚度矩阵的奇异性，可用来计算具有刚体模态的特征值问题；其二是可以加快求解速度，因为移轴可以使相邻近的两个特征值的比值λi+1/λi，变大，使求解速度加快。
(6)	采用移轴，对[K]-µ[M]做[L][D][L]T三角分解，则对角阵[D]中负元素个数就等于比µ小的特征值的个数。例如，入i<µ<入i+1，则[D]中负元素的个数刚好为i个。此特性称为特征值问题的Sturm序列特征。可用此特性构造求解特征值的方法，也可用于检查求解过程中是否出现丢根。
(7)	求解特征值问题经常要用到相似变换，采用相似变换不改变原问题的特征值。设[P]为非奇异矩阵，使
则称[K]矩阵与［ ]矩相阵似。
由式(51-6)有标准特征值的公式
令 =[P]{Φ}，则可推得
式(51-6)和式(51-26)具有相同的特征值。
如果[P]为正交矩阵，即[P]T[P]=[I]，则上述相似变换称为正交相似变换，如果原矩阵［ ]为对称矩阵，则变换后的矩阵[K]仍保持为对称矩阵，给求解带来很多方便。
(8)	定义
为Ryleigh商。其中{X}为n维空间的任一非零向量，显然，当{X}={Φi}时可有
可以证明，对任何{X}，有
并且有 
51.3特征值问题的解法
51.3.1特征值问题解法分类
特征值问题的解法大体上可分为4类。
(1)	矢量迭代法。所用的基本性质是
矢量迭代法可分为逆迭代法和正迭代法。
(2)	变换方法。所用的基本性质是 
式中：[Φ]——nxn阶矩阵。
(3)	多项式迭代技术。使用的基本性质是
式中	 
(4)	应用特征多项式Sturm序列特性求解。
通过上述基本类型的组合，已发展出很多有效的求解方法，如行列式搜索法、子空间迭代法，Lanczos法和QR法等。
值得注意的是，在所有的求解方法中，都要采用迭代技术，因为求解特征值问题[K]{Φ}＝λ[M]{Φ}等效于计算多项式P（λ）的根，而P（λ）的阶数等于[K]和[M]矩阵的阶数。当P的阶数大于4时，没有封闭形式公式用于计算P（λ）的根，必须用迭代方法。
虽然要用迭代技术求解特征对（λi，{Φi}，但特征对之一已经计算出后，不用继续迭代可得特征对中的另一个。假设已由迭代计算出λi，则可用下式计算出{Φi}
反之，如果已迭代计算出{Φi}，则可用Rayleigh商计算出特征值λi，公式如下
按其求特征值和特征向量的顺序可有下述三种情况：
(1)	先求特征值，再求特征向量；
(2)	先求特征向量，再求特征值；
(3)	同时求出特征值和特征向量。
51.3.2矢量迭代法
矢量迭代法又称幂法，既可用于标准特征值问题，又可用于广义特征值问题。既适用于对称矩阵，也适用于非对称矩阵，因此它的适用范围很广泛，在行列式搜索法和子空间迭代法中都要用到矢量逆迭代法，因此以下对它进行较详细的讨论。
51.3.2.1矢量逆迭代法
此节假定[K]是正定矩阵，[M]可为一致质量阵或对角矩阵，此对角质量阵可以有零元素。如果[K]是半正定矩阵，可在迭代之前采用移轴变换。
任意选取一个初始迭代矢量{X1}，按下述基本格式进行迭代
或写成
只要{X1}和{Φ1}对于[M]不正交，即{X1}T[M]{Φ1}≠0，当k→∞时，{Xk+1}→{Φ1}。公式(51-35)实际上是对{Xk+1}做规一化处理，使得{Xk+1}T[M]{Xk+1}=1。
式(51-33)和式(51-34)是基本迭代格式，在计算机程序中常采用下述更有效的迭代格式：选取初始矢量{Y1}=[M]{X1}，对k=1，2，…计算
只要λ1在此迭代步满足要求的精度，则停止迭代，得到了λ1和{Φ1}。上述基本的矢量逆迭代法只能求出λ1和{Φ1}，即最小的特征值及对应的特征向量。如果想求出下一个特征对，就要保证初始迭代矢量不含{Φ1}的成分，并且迭代过程中的{Xk}都不含{Φ1}的成分。因此需从{Xk}中扫除{Φ1}。
51.3.2.2带移轴的矢量逆迭代法
在矢量逆迭代法中，引入移轴变换可以加快迭代求解的收敛速度。例如，如果
λ1/λ2＝0.9999，则收敛速度很慢；如果λ1/λ2=0.01，则收敛速度可以很快。通过移轴变换可以改变两个最小特征值的位置，改变它们的比值，加快收敛速度。另外，在矢量逆迭代法中引入移轴变换可以消除刚度矩阵[K]的奇异性。
关于移轴变换的特性，在51.2中已有叙述。
51.3.3矩阵变换方法
变换方法利用特征向量[Φ]的下述基本特性
此式即51.2中的式(51-17)和式(51-18)，其中[Φ]为nxn阶矩阵，它使[M]和[K]阵对角化，且是惟一的。用[pk]T和[pk]，k=1，2，…逐次前乘和后乘[K]和[M]矩阵，可使[K]和[M]矩阵趋于对角阵。
如果取[K1]=[K]，[M1]=[M]，则有
在选取[pk]时，应能使[K]和[M]阵按式(51-40)和式(51-41)的迭代形式趋于对角阵。当k→∞时，[Kk+1]→[λ]，[Mk+1]→[I]。如果用l表示最后一次迭代，则有
实际上，不需要[Mk+I]收敛到[I]，[Kk+I]收敛到[Λ]。只要收敛到对角阵即可。当k→∞时，[Kk+1]→diag（Kr），[Mk+1]→diag（Mr），则有
下面介绍QR算法。
51.3.3.1化一般矩阵为上Hessenberg型矩阵
计算一般矩阵的特征值或同时计算其特征向量之前，先把矩阵化为上Hessenberg型矩阵（以下简写为上H—阵），可节省较多工作量。上H一阵的元素当i>j+1时，hij=0。通常，化一般阵为上H—阵，采用初等变换矩阵或正交矩阵（如Householder变换）做变换，均可达到较稳定的效果。
Householder变换矩阵如下
式中：[/]——nxn阶单位矩阵，{W}为n维列向量，满足
一般，{W}的前k个分量取作零，即有
容易验证，[P]是一个对称正交阵。
用Householder变换把一实矩阵[A]化为上H—阵，需要通过n-2次相似变换，对矩阵[A]由左到右逐列使其符合上H-阵的形式。并可证明，对某列进行变换时，对此列左边部分的列不起作用。
现设[A1]=[A]，经过k-1次变换后得到[Ak]，它的前k-1列已化为上H—阵的形式，则矩阵[Ak+I]可由[Ak]通过下关系式导出
式中：[pk]——Householder变换。
51.3.3.2QR算法
基本QR算法是这样的：设[A1]=[A]是nxn阶的上H—阵，则用下述递推公式
基本QR算法收敛往往很慢，由此通常采用原点位移的策略，带原点移动的QR算法的基本关系如下
式中，[Qk]是正交阵；[Rk]是上三角形矩阵；µk是原点移动量。显然[Ak+I]与[Ak]相似，任一[Ak]与原始矩阵[A1]=[A]相似。原始矩阵[A1]是上H—阵，则所有的[Ak]也是上H—阵。
经上述变换后，最终[A]将成为上三角形矩阵，其对角线元素就是所求的特征值。QR算法本身不能计算特征向量，只能通过其他方法，例如根据近似特征值求特征向量。QR算法是求一般矩阵全部特征对的最有效方法之一，其优点是计算过程特别稳定，收敛较快。
51.3.4	多项式迭代法
由51.2中介绍的特征值问题的数学性质，公式(51-8)可知
P(λ）的根为特征值问题[K]{Φ}＝λ[M]{Φ}的特征值。在多项式迭代法中，直接使用[K]和[M]矩阵，不用事先对其作任何转换。用多项式迭代法只能求出特征值，而相应的特征向量则用带移轴变换的矢量逆迭代法求出。
P(λ）是λ的n次多项式，以变量λ为横坐标，则P(λ）在平面上是一条n次曲线，与横坐标相交n次，有n个零点，见图51-1。
求解特征多项式根的一般方法是把P(λ）写成
然后由[K]和[M]矩阵的元素可算得系数a0，a1，…，an。一旦确定了这些系数可用标准的多项式求根方法，例如牛顿迭代法或割线法求出要求的特征值。但是，当[K]和[M]的阶次很高时，很难求出特征多项式的系数。求行列式的值可用三角分解
式中：[D]——对角阵
割线法的迭代公式，实际上是一系列线性插值，令µk-1<µk，则用下式迭代出根的近似值
须指出的是，多项式迭代法的计算量是很大的，多项式迭代法只能求出特征值，而特征向量还需进一步计算。
51.3.5	用Sturm序列特性求解
在51.2中叙述了Sturm序列特性，采用移轴，对[K]-µk[M]做三角分解[L][D][L]T，则对角阵[D]中负元素的个数等于比µk小的特征值的个数。可用此特性直接构造求解特征值和相应特征向量的方法。
常用的方法为Sturm序列二分法，可用此法求出任意两个给定的λ1和λu之间的全部特征值。其中λ1为所求区间的下限，λu为上限。如果取入λ1=0，则可求解小于λu的全部低阶特征值。Sturm序列二分法是通过适当的选取µk，并判断三角分解后[D]中负元素的个数，从而判定每个特征值所在的区间。其过程如下：
(1)	分解[K]-λ1[M]为[L][D][L]T，确定有多少个特征值小于λ1，记为q1。
(2)	分解[K]-λu[M]为[L][D][L]T，确定有多少个特征值小于λu，记为qu。则区间λ1和λu之间有qu-q1个特征值。
(3)	取λm＝（λ1＋λu）/2。以λ1和λm、λm和λu各作为一个区间，重复(1)、(2)两步，确定λ1和λm之间特征值的个数以及仁和λm和λu之间特征值的个数。依此类推，直至某一区间内只有一个特征值。
(4)	检查特征值的精度，如果满足精度要求，则用矢量逆迭代法得到相应的特征向量。
在第(4)步，要得到足够的精度，就必须多次对[K]-µk[M]做三角分解，要花费很大工作量。一般只运算到第(3)步，划出各特征值所在的区间，然后用多项式迭代或矢量迭代法求解。
如果特征值为重根或密集在某一区间，则第(3)步运算也要花费大量时间。因此	Sturm序列法很少单独使用，经常作为其他方法的一种辅助方法。
51.3.6	其他方法简介
通过上述典型解法的组合和变换，目前已经发展出很多适于大中型结构特征值问题的解法，例如行列式搜索法、子空间迭代法，Lanczos法等。
行列式搜索法综合运用了多项式迭代法，带移轴的矢量逆迭代法，Sturm序列特性。第一步先用多项式迭代法尽快地求出一个比较精确的特征值的近似值。第二步用矢量逆迭代法，首先按多项式迭代法中得到的近似值做移轴处理，用矢量逆迭代法得到更精确的特征值及对应的特征向量。
子空间迭代法实质上是Rayleigh—Ritz方法和同时逆迭代法的组合，用于求解大型特征值的低阶部分特征值和特征向量。
Lanczos法实质上是矢量迭代法、Ritz分析和解三对角矩阵特征值的组合。其计算量比子空间迭代法要少得多。
子空间迭代法和Lanczos法都用到了Rayleigh—Ritz原理，使求解特征值问题方程的阶数大为降低，提高求解速度。此内容在下一节矩阵减缩中介绍。
51.4	矩阵减缩
结构为连续弹性体，离散化后得刚度矩阵[K]和质量矩阵[M]，自由度数为n，对应的物理坐标为{μ}，见式(51-1)到式(51-6)。在51.3中所述各种特征值问题的解法，都是直接对n阶的[K]矩阵和[M]矩阵进行运算，在物理坐标系下求解特征值问题。由于航空结构的复杂性，有限元规模增大，矩阵[K]和[M]的阶数很高，因此人们探索降低方程阶数的各种方法。本节介绍几种减缩矩阵阶数的方法。
51.4.1	静力减缩
在求解特征对计算中，采用静力减缩的基本假设是，结构质量被堆聚在某些指定的自由度上，即采用了堆聚质量矩阵，质量矩阵[M]为对角阵，并具有很多零对角线项。这种方法非常符合工程实际，复杂的航空结构很难用一致的质量矩阵，总是将结构质量按工程师的经验堆聚在指定节点上。
按照上述假设划分[K]和[M]矩阵，则特征值问题[K]{Φ}＝λ[M]具有如下形式
式中，{Φa}和{Φ0}分别为有质量自由度和无质量自由度的位移；[Ma]为对角矩阵。由公式(51-53)可有
由公式(51-54)可得到
将{Φ0}代入式(51-53)，可得到降阶的特征值问题
解方程(51-56)可得特征值λ和特征向量{Φa}。其无质量自由度的特征向量{Φ0}可由公式(55-55)算得。
静力减缩的限制是，必须仔细选择质量堆聚的自由度。如果选择得合理，则可以得到好的结果，设减缩后方程(51-56)的阶数为P，则最低阶的P/3个特征对，误差可在5%以内。
另外，减缩后的刚度矩阵[Ka]的带宽比[K]矩阵大，如果[Ka]的阶数增大，要求的计算代价也会迅速增大。
目前，静力减缩已被下面介绍的更先进的计算方法所代替，只在少数情况下还有应用。
51.4.2	Rayleigh-Ritz分析及子空间迭代法和Lanczos法
51.4.2.1	Rayleigh-Ritz分析
Rayleigh-Ritz分析法又称Ritz变换，其最大优点是降低方程阶数，简化计算，求出低阶特征对的很好的近似值。低阶特征对在工程实际应用中非常重要，例如颤振分析、突风响应分析，所感兴趣的都是低阶模态。
由Rayleigh商公式(51-27)和公式(51-28)有
上述取极小的过程是在n个特征向量构成的n维空间中进行的，即对应于物理坐标系。Ritz分析的思想是，取极小的过程，可以近似地在一个低阶的q维空间中进行。如果想求结构前p阶特征对，一般取q=min(2p，p+8)。
取q个已知的线性无关矢量{Yi}，i=1，2，...，q，令{X}为这些矢量的线性组合，则有
式中，[Y]是Ritz向量基构成的nxq阶矩阵；{A}为特定矢量。由下述过程可导出新的广义特征值问题
R（{X}）取最小值的必要条件是
利用二次型对矢量求偏导法则可得
代入式（51-62）可有
这是一个新的广义特征值问题，式中[K]*和[M]*是qXq阶矩阵，{A}小是Ritz坐标矢量。[K]*和[M]*可称为原刚度矩阵和质量矩阵在[Y]所构成的q维子空间上的投影，原系统的特征值问题转换为q阶广义特征值问题，见式(51-63)。由于q<n，所以式(51-63)相对来说容易求解。解式(51-63)可得q个特征值及对应的特征向量，原结构的特征向量的近似值可由式(51-59)算得。
此法算得的低阶特征对效果较好。
51.4.2.2子空间迭代法
子空间迭代法实质上是Rayleigh-Ritz方法和同时逆迭代法的组合。同时逆迭代法又称矩阵迭代法，它以一组矢量构成的矩阵代替原来的单个矢量，然后用逆迭代法进行迭代，最后就能得到一组特征对，其迭代步骤完全与矢量逆迭代法相同。
为了保证初始矩阵中每个矢量收敛到不同的特征向量，必须在每一步迭代中使这一组特征向量之间关于[M]正交。同时逆迭代法第k步迭代公式如下
在上节Rayleigh-Ritz分析方法中，Ritz向量基[Y]是人为假设的，很难接近真实的低阶特征子空间。如果选用同时逆迭代法的结果做为Ritz向量基，则nxq阶的[ k+I]更接近真实的特征子空间。用[ k+I]作为Ritz向量基，形成qxq阶的子空间投影矩阵[K]*和[M]*，见公式(51-61)，进而求解q维空间中的广义特征值问题，公式(51-63)将得到的原结构的特征向量{Φ1}，{Φ2}，…，{Φq}的近似值作为新的初始迭代矢量，进行同时逆迭代，见公式(51-64)，然后再进行Ritz分析。如此循环，将得到很好的收敛结果。
子空间迭代法可归纳为下列三步：
(1)	确定q个初始迭代矢量，如果要计算p个特征对，一般取q=min(2p，p+8)。
(2)	用同时逆迭代法和Ritz分析，使q个迭代矢量逼近低阶特征子空间，得到特征对。
(3)	迭代收敛以后，用Sturm序列验证已算出的特征对。
51.4.2.3Lanczos法
Lanczos法实质上是矢量迭代法，Ritz分析和解三对角矩阵特征值问题的组合。先用矢量迭代法生成具有正交性的近似的Ritz矢量组，即Ritz向量基，由Ritz变换将原问题转换为低阶的三对角矩阵，最后求解三对角矩阵的特征值，也就是原问题的一组特征值，最后将三对角矩阵的特征向量通过Ritz基变换，得到原问题的特征向量。
广义特征值问题写为 
其中，[K]为n×n阶实对称正定矩阵，[M]为对称矩阵。选取初始迭代矢量{U1}，且
当k=q时，做完(1)后，即求出aq后停止迭代。迭代过程中所得到的全部ak和βk构成一个q阶的三对角矩阵
求解[Tq]矩阵的标准特征值问题，可得全部特征值λi，(i=l，2，…，q)，就是广义特征值问题由小到大排列前q个特征值的近似值。
Lanczos法与子空间迭代法相比，计算量要少得多，已被广泛用于求解大型特征值问题。
51.4.3子结构模态综合法
51.4.3.1引言
一架飞机是一个大型复杂结构，其有限元模型的阶数可达几千阶甚至几万阶。如果用前面介绍的各种求特征值的方法直接计算，通常是很困难的，有时计算机条件也不允许。
在结构静力分析中，把大型结构分成若干个子结构，先对子结构进行分析，然后综合组装再做整体分析。在求解大型结构特征值时也可采用与此类似的方法。
子结构模态综合法又可称为分支模态综合法或部件模态综合法。其基本思想就是Rayleigh-Ritz分析。
51.4.3.2子结构模态综合法的基本原理和方法
首先将一个整体结构分成若干个子结构，为了说明问题方便，假设分成两个子结构a和β，每个子结构的自由度分为内部自由度{ui}和界面自由度{ub}。对a和β两个子结构可有
整个系统的动能为
整个系统的势能为
式中，[ma]、[mβ]、[ka]和[kβ]分别为子结构a和β的结构质量和刚度矩阵。
对子结构a和β分别求解特征值问题，选取合适的模态集作为a和β子结构的Ritz向量基，可有变换
式中，[pa]和[pβ]为两个子结构的模态坐标。将式(51-68)代入式(51-66)和式(51-67)可得 
两个子结构在界面处是连续的，可有
对子结构a和β，式(51-68)可写成
由式(51-70)和式(51-71)可得
进而写成 	 
式中，[C]=[[φab]-[φβb]]，由式(51-73)可知，{p}中的坐标不都是独立的，令独立的坐标为{q}，则可有
将式(51-74)代入式(51-69)可有
式中，[M]*=[S]T[M][S]，[K]*=[S]T[K][S]。
系统的无阻尼自由振动方程为
相应的广义特征值问题为
此方程的阶数远小于整个结构物理自由度。由上述可见，有两次变换，第一次是对子结构做分支模态变换；第二次由结构界面连接条件消去不独立模态坐标。
51.4.3.3子结构模态集的选取
模态综合方法的过程是，先将无限自由度的连续弹性子结构离散成结点坐标{u}，即物理坐标，自由度数为n。然后选择特征向量矩阵[Φ]作为基底，将物理坐标转换为模态坐标，此过程有人称为模态代入变换，公式为
如果[Φ]矩阵的列数p=n，则方程(51-78)只是一种等价变换，并无坐标减缩，在{u}叫坐标系下和{p}坐标系下所得结果完全一致。有实际意义的是取p<n，将其余n-p个模态丢弃不用，这一方法称为模态截尾。
如何选取矩阵[Φ]，既能大幅度地减缩自由度数(p<n)，又能尽量减少截尾误差，实际上是如何选取子结构模态集的问题。由于结构的低频段最具有工程意义，因此模态综合法总是丢弃高阶模态，自某阶模态起，去掉一切高阶模态。此方法称为模态截尾。
子结构模态综合法主要分为两类，其一是自由界面子结构模态综合法；其二是固定界面子结构模态综合法。自由界面子结构是在求解子结构的内部主模态时，在子结构的界面上不加任何附加约束，可得到自由界面分支主模态。固定界面子结构，在求子结构主模态时，界面坐标是固定的。
下面以固定界面子结构模态综合法说明子结构模态集的选取方法。从运动学的观点来构造子结构的Ritz向量基，子结构内部任一点的位移，可用下面三种类型的运动来描述，即
(1)	界面全部加上附加约束，求子结构的特征对，得子结构固定界面分支主模态；
(2)	静定附加约束释放后，刚体位移引起的牵连位移，称为刚体模态；
(3)	超静定附加约束释放后，引起的牵连位移，称为约束模态。
上述三种位移叠加，可得子结构内部和界面节点的位移。此三种位移分别称为主模态、刚体模态和约束模态。此三种模态构成子结构完备的模态集，矩阵的减缩主要是对主模态进行截尾。
有的方法统一处置界面自由度，不区分静定附加约束释放和超静定附加约束释放引起的刚体运动模态和约束模态。因为高度超静定对接的结构，哪些自由度作为静定对接自由度，哪些作为超静定自由度，并没有区分准则。因此用于分析飞机那样高赘余对接的结构很方便。
51.5	选取特征值解法的准则
在选取特征值解法时，必须注意的是，不存在一种解法在各种情况下始终有效。选用哪种解法主要取决于[K]和[M]矩阵的特性，其主要是矩阵的阶数和带宽。选用哪种解法也取决于所求特征对的个数。另外，必须清楚各种解法的精度、可靠性、代价和方便性。
一般来说，如果整体结构的自由度数大于10000，最好采用子结构模态综合方法。目前，在整架飞机求解时，有限元模型的阶数约有几千阶或一万阶左右；所需求解特征对约30个。因此，一般采用子空间迭代法或Lanczos方法。
在大型结构分析软件系统MSC/NASTRAN的手册中，按照求解特征对的个数，有限元模型的自由度数，推荐了一张图供用户参考。现将此图列在图51-2中。